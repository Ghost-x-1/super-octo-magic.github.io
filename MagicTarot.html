<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ÊòüËæ∞Â°îÁΩóÊó•Ëøê</title>
    <style>
        :root {
            --purple-dark: #1a103d;
            --purple-mid: #3d2e8f;
            --purple-light: #6a4cbf;
            --gold: #f8d56b;
            --pink: #e6a8d7;
        }
        
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: radial-gradient(circle at 10% 20%, var(--purple-dark) 0%, #000 60%);
            color: #e6e6e6;
            min-height: 100vh;
            padding: 15px;
            margin: 0;
            line-height: 1.5;
            -webkit-text-size-adjust: 100%;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 10px;
        }
        
        h1 {
            color: var(--gold);
            text-align: center;
            margin: 15px 0;
            font-size: 1.8rem;
        }
        
        .settings {
            background: rgba(61, 46, 143, 0.3);
            padding: 12px;
            border-radius: 10px;
            margin-bottom: 15px;
            text-align: center;
            font-size: 0.95rem;
        }
        
        .btn {
            background: var(--purple-light);
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 1rem;
            border-radius: 50px;
            cursor: pointer;
            display: block;
            margin: 20px auto;
            transition: all 0.3s;
            width: 80%;
            max-width: 250px;
            font-weight: bold;
        }
        
        .btn:hover {
            background: var(--purple-mid);
            transform: translateY(-3px);
        }
        
        .btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }
        
        .card-container {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
            perspective: 1000px;
        }
        
        .card {
            width: 28vw;
            height: 48vw;
            max-width: 120px;
            max-height: 200px;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.8s;
            cursor: pointer;
            border-radius: 8px;
            margin: 5px;
        }
        
        .card.flipped {
            transform: rotateY(180deg);
        }
        
        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            padding: 8px;
            text-align: center;
        }
        
        .card-front {
            background: linear-gradient(135deg, #f8d56b 0%, #e6a8d7 100%);
            color: var(--purple-dark);
            transform: rotateY(180deg);
        }
        
        .card-back {
            background: linear-gradient(135deg, var(--purple-mid) 0%, var(--purple-dark) 100%);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .card-back::before {
            content: "";
            position: absolute;
            width: 80%;
            height: 80%;
            border: 2px solid var(--gold);
            border-radius: 6px;
            opacity: 0.5;
        }
        
        .card-back::after {
            content: "‚ú¶";
            font-size: 30px;
            color: var(--gold);
            opacity: 0.7;
        }
        
        .card-name {
            font-size: 0.85rem;
            font-weight: bold;
            margin-bottom: 4px;
            word-break: break-word;
        }
        
        .card-suit {
            font-size: 0.7rem;
            font-style: italic;
            margin-bottom: 4px;
        }
        
        .card-orientation {
            font-size: 0.75rem;
            color: var(--purple-mid);
            font-weight: bold;
        }
        
        .reading-area {
            background: rgba(26, 16, 61, 0.7);
            border-radius: 12px;
            padding: 15px;
            margin-top: 20px;
            transition: all 0.5s ease-in-out;
            font-size: 0.95rem;
        }
        
        .category {
            margin-bottom: 18px;
        }
        
        .category-title {
            color: var(--gold);
            font-size: 1.1rem;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }
        
        .category-title .icon {
            margin-right: 8px;
            font-size: 1em;
        }
        
        .hidden {
            display: none;
        }
        
        .error {
            color: #ff6b6b;
            text-align: center;
            margin: 15px 0;
            font-size: 0.95rem;
        }
        
        @keyframes dealCard {
            0% {
                transform: translateY(-50px) rotateY(-90deg);
                opacity: 0;
            }
            100% {
                transform: translateY(0) rotateY(0);
                opacity: 1;
            }
        }
        
        .card.dealing {
            animation: dealCard 0.8s ease-out forwards;
        }
        
        /* ÁªºÂêàËß£ËØªÊ†∑Âºè */
        .overall-reading {
            background: rgba(106, 76, 191, 0.2);
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 20px;
            border-left: 4px solid var(--gold);
        }
        
        .overall-title {
            color: var(--gold);
            font-size: 1.2rem;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }
        
        .energy-bar-container {
            margin: 12px 0;
        }
        
        .energy-bar {
            height: 18px;
            background: rgba(255,255,255,0.1);
            border-radius: 9px;
            overflow: hidden;
            position: relative;
        }
        
        .energy-level {
            height: 100%;
            background: linear-gradient(90deg, #f44336, #FFC107, #4CAF50);
            transition: width 1s ease;
            border-radius: 9px;
        }
        
        .energy-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 0.75rem;
            color: rgba(255,255,255,0.7);
        }
        
        .element-tags {
            display: flex;
            gap: 6px;
            margin: 8px 0;
            flex-wrap: wrap;
        }
        
        .element-tag {
            background: rgba(248, 213, 107, 0.2);
            border: 1px solid var(--gold);
            border-radius: 12px;
            padding: 2px 8px;
            font-size: 0.75rem;
        }
        
        .advice-box {
            background: rgba(230, 168, 215, 0.1);
            border-radius: 8px;
            padding: 10px;
            margin-top: 12px;
            border-left: 3px solid var(--pink);
        }
        
        .advice-title {
            color: var(--pink);
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }
        
        /* ÂìçÂ∫îÂºèË∞ÉÊï¥ */
        @media (max-width: 480px) {
            .card {
                width: 30vw;
                height: 50vw;
            }
            
            .card-name {
                font-size: 0.8rem;
            }
            
            .reading-area {
                padding: 12px;
            }
            
            .btn {
                width: 90%;
                padding: 12px;
            }
        }
        
        @media (max-width: 360px) {
            .card {
                width: 28vw;
                height: 48vw;
            }
            
            .card-name {
                font-size: 0.75rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚ú® Â°îÁΩóÊó•ËøêÂç†Âçú ‚ú®</h1>
        
        <div class="settings">
            <label>
                <input type="radio" name="deckType" value="full" checked> ‰ΩøÁî®ÂÆåÊï¥78Âº†ÁâåÁªÑ
            </label>
        </div>
        
        <button id="drawBtn" class="btn">ÊäΩÂèñ‰ªäÊó•ËøêÂäø</button>
        
        <div id="cardDisplay" class="card-container hidden"></div>
        
        <div id="errorMsg" class="error hidden"></div>
        
        <div id="readingDisplay" class="reading-area hidden">
            <div class="overall-reading">
                <div class="overall-title">
                    <span class="icon">üîÆ</span>‰ªäÊó•ÁªºÂêàËøêÂäø
                </div>
                <div id="overallReading"></div>
                <div class="energy-bar-container">
                    <div class="energy-bar">
                        <div class="energy-level" id="energyLevel"></div>
                    </div>
                    <div class="energy-labels">
                        <span>‰ΩéËÉΩÈáè</span>
                        <span>‰∏≠ËÉΩÈáè</span>
                        <span>È´òËÉΩÈáè</span>
                    </div>
                </div>
                <div class="element-tags" id="elementTags"></div>
                <div class="advice-box">
                    <div class="advice-title">‚ú® ‰ªäÊó•ÁÆ¥Ë®Ä</div>
                    <div id="dailyAdvice"></div>
                </div>
            </div>
            
            <div class="category">
                <div class="category-title">
                    <span class="icon">üè¢</span>Â∑•‰ΩúËøêÂäø
                </div>
                <div id="workReading"></div>
            </div>
            
            <div class="category">
                <div class="category-title">
                    <span class="icon">‚ù§Ô∏è</span>ÊÉÖÊÑüÁä∂ÊÄÅ
                </div>
                <div id="loveReading"></div>
            </div>
            
            <div class="category">
                <div class="category-title">
                    <span class="icon">üìö</span>Â≠¶‰π†ËÉΩÈáè
                </div>
                <div id="studyReading"></div>
            </div>
        </div>
    </div>

    <script>
        // Â°îÁΩóÁâåÊï∞ÊçÆÂ∫ì
        const tarotDB = {
            major: [
                { name: "0. ÊÑöËÄÖ", keywords: ["ÂÜíÈô©", "Â§©Áúü", "Êñ∞ÁöÑÂºÄÂßã"], element: "È£é" },
                { name: "I. È≠îÊúØÂ∏à", keywords: ["ÂàõÈÄ†", "ÊäÄËÉΩ", "‰∏ìÊ≥®"], element: "Ê∞¥Êòü" },
                { name: "II. Â•≥Á•≠Âè∏", keywords: ["Áõ¥Ëßâ", "Á•ûÁßò", "Êô∫ÊÖß"], element: "Êúà‰∫Æ" },
                { name: "III. ÁöáÂêé", keywords: ["‰∏∞Áõõ", "ÊªãÂÖª", "ÊÑüÊÄß"], element: "ÈáëÊòü" },
                { name: "IV. ÁöáÂ∏ù", keywords: ["ÊùÉÂ®Å", "ÁªìÊûÑ", "ÊéßÂà∂"], element: "ÁôΩÁæäÂ∫ß" },
                { name: "V. ÊïôÁöá", keywords: ["‰º†Áªü", "‰ø°‰ª∞", "ÊïôËÇ≤"], element: "ÈáëÁâõÂ∫ß" },
                { name: "VI. ÊÅã‰∫∫", keywords: ["ÂÖ≥Á≥ª", "ÈÄâÊã©", "ÂíåË∞ê"], element: "ÂèåÂ≠êÂ∫ß" },
                { name: "VII. ÊàòËΩ¶", keywords: ["ËÉúÂà©", "ÊÑèÂøóÂäõ", "ÂâçËøõ"], element: "Â∑®ËüπÂ∫ß" },
                { name: "VIII. ÂäõÈáè", keywords: ["ÂãáÊ∞î", "ËÄêÂøÉ", "ÂÜÖÂú®ÂäõÈáè"], element: "ÁãÆÂ≠êÂ∫ß" },
                { name: "IX. ÈöêÂ£´", keywords: ["ÂÜÖÁúÅ", "Â≠§Áã¨", "ÊåáÂºï"], element: "Â§ÑÂ•≥Â∫ß" },
                { name: "X. ÂëΩËøê‰πãËΩÆ", keywords: ["ÂëΩËøê", "ÂèòÂåñ", "Âë®Êúü"], element: "Êú®Êòü" },
                { name: "XI. Ê≠£‰πâ", keywords: ["ÂÖ¨Âπ≥", "ÁúüÁõ∏", "Âõ†Êûú"], element: "Â§©Áß§Â∫ß" },
                { name: "XII. ÂÄíÂêä‰∫∫", keywords: ["Áâ∫Áâ≤", "Êñ∞ËßÜËßí", "Á≠âÂæÖ"], element: "Ê∞¥" },
                { name: "XIII. Ê≠ªÁ•û", keywords: ["ÁªìÊùü", "ËΩ¨Âèò", "Êñ∞Áîü"], element: "Â§©ËùéÂ∫ß" },
                { name: "XIV. ËäÇÂà∂", keywords: ["Âπ≥Ë°°", "Ë∞ÉÂíå", "ÈÄÇÂ∫¶"], element: "Â∞ÑÊâãÂ∫ß" },
                { name: "XV. ÊÅ∂È≠î", keywords: ["ÊùüÁºö", "Áâ©Ë¥®", "Ê¨≤Êúõ"], element: "Êë©ÁæØÂ∫ß" },
                { name: "XVI. È´òÂ°î", keywords: ["Á™ÅÂèò", "ÂêØÁ§∫", "Ëß£Êîæ"], element: "ÁÅ´Êòü" },
                { name: "XVII. ÊòüÊòü", keywords: ["Â∏åÊúõ", "ÁÅµÊÑü", "Ê≤ªÊÑà"], element: "Ê∞¥Áì∂Â∫ß" },
                { name: "XVIII. Êúà‰∫Æ", keywords: ["ÂπªËßâ", "ÊΩúÊÑèËØÜ", "‰∏çÂÆâ"], element: "ÂèåÈ±ºÂ∫ß" },
                { name: "XIX. Â§™Èò≥", keywords: ["Âø´‰πê", "ÊàêÂäü", "Ê¥ªÂäõ"], element: "Â§™Èò≥" },
                { name: "XX. ÂÆ°Âà§", keywords: ["ËßâÈÜí", "ÈáçÁîü", "Ëµ¶ÂÖç"], element: "ÁÅ´" },
                { name: "XXI. ‰∏ñÁïå", keywords: ["ÂÆåÊàê", "ÊàêÂ∞±", "ÊóÖË°å"], element: "ÂúüÊòü" }
            ],
            minor: {
                wands: [
                    { name: "ÊùÉÊùñ‰∏Ä", keywords: ["ËÉΩÈáè", "ÁÅµÊÑü", "Ë°åÂä®"], number: 1, element: "ÁÅ´" },
                    { name: "ÊùÉÊùñ‰∫å", keywords: ["ËÆ°Âàí", "Êú™Êù•", "ÂÜ≥ÂÆö"], number: 2, element: "ÁÅ´" },
                    { name: "ÊùÉÊùñ‰∏â", keywords: ["ËøúËßÅ", "Êâ©Âº†", "È¢ÜÂØº"], number: 3, element: "ÁÅ´" },
                    { name: "ÊùÉÊùñÂõõ", keywords: ["Â∫ÜÁ•ù", "ÂíåË∞ê", "ÂÆ∂"], number: 4, element: "ÁÅ´" },
                    { name: "ÊùÉÊùñ‰∫î", keywords: ["ÂÜ≤Á™Å", "Á´û‰∫â", "‰∫âËÆ∫"], number: 5, element: "ÁÅ´" },
                    { name: "ÊùÉÊùñÂÖ≠", keywords: ["ËÉúÂà©", "ËøõÊ≠•", "ËÆ§ÂèØ"], number: 6, element: "ÁÅ´" },
                    { name: "ÊùÉÊùñ‰∏É", keywords: ["ÊåëÊàò", "ÂùöÊåÅ", "Èò≤Âæ°"], number: 7, element: "ÁÅ´" },
                    { name: "ÊùÉÊùñÂÖ´", keywords: ["ÈÄüÂ∫¶", "Ë°åÂä®", "Ê∂àÊÅØ"], number: 8, element: "ÁÅ´" },
                    { name: "ÊùÉÊùñ‰πù", keywords: ["ÊØÖÂäõ", "Ë≠¶ÊÉï", "ÂäõÈáè"], number: 9, element: "ÁÅ´" },
                    { name: "ÊùÉÊùñÂçÅ", keywords: ["Ë¥üÊãÖ", "Ë¥£‰ªª", "ÂéãÂäõ"], number: 10, element: "ÁÅ´" },
                    { name: "ÊùÉÊùñ‰æç‰ªé", keywords: ["Êé¢Á¥¢", "ÁÉ≠ÊÉÖ", "Ê∂àÊÅØ"], court: "‰æç‰ªé", element: "ÁÅ´" },
                    { name: "ÊùÉÊùñÈ™ëÂ£´", keywords: ["ËÉΩÈáè", "ÂÜíÈô©", "ÂÜ≤Âä®"], court: "È™ëÂ£´", element: "ÁÅ´" },
                    { name: "ÊùÉÊùñÁöáÂêé", keywords: ["Ê¥ªÂäõ", "Ëá™‰ø°", "Ê∏©Êöñ"], court: "ÁöáÂêé", element: "ÁÅ´" },
                    { name: "ÊùÉÊùñÂõΩÁéã", keywords: ["È¢ÜÂØº", "ËøúËßÅ", "‰ºÅ‰∏öÂÆ∂"], court: "ÂõΩÁéã", element: "ÁÅ´" }
                ],
                cups: [
                    { name: "Âú£ÊùØ‰∏Ä", keywords: ["ÊÉÖÊÑü", "Áõ¥Ëßâ", "Êñ∞ÂÖ≥Á≥ª"], number: 1, element: "Ê∞¥" },
                    { name: "Âú£ÊùØ‰∫å", keywords: ["ÂíåË∞ê", "Âêà‰Ωú", "ÊÑüÊÉÖ"], number: 2, element: "Ê∞¥" },
                    { name: "Âú£ÊùØ‰∏â", keywords: ["Â∫ÜÁ•ù", "ÂèãË∞ä", "ÂàõÈÄ†Âäõ"], number: 3, element: "Ê∞¥" },
                    { name: "Âú£ÊùØÂõõ", keywords: ["Ê≤âÊÄù", "‰∏çÊª°", "Êó†ËÅä"], number: 4, element: "Ê∞¥" },
                    { name: "Âú£ÊùØ‰∫î", keywords: ["Â§±ËêΩ", "ÈÅóÊÜæ", "ÊÇ≤‰º§"], number: 5, element: "Ê∞¥" },
                    { name: "Âú£ÊùØÂÖ≠", keywords: ["ÊÄÄÊóß", "Á´•Âπ¥", "Á§ºÁâ©"], number: 6, element: "Ê∞¥" },
                    { name: "Âú£ÊùØ‰∏É", keywords: ["ÈÄâÊã©", "ÂπªÊÉ≥", "ÁôΩÊó•Ê¢¶"], number: 7, element: "Ê∞¥" },
                    { name: "Âú£ÊùØÂÖ´", keywords: ["Á¶ªÂºÄ", "ÂØªÊâæ", "ÊîæÂºÉ"], number: 8, element: "Ê∞¥" },
                    { name: "Âú£ÊùØ‰πù", keywords: ["Êª°Ë∂≥", "ÊÑøÊúõ", "Âø´‰πê"], number: 9, element: "Ê∞¥" },
                    { name: "Âú£ÊùØÂçÅ", keywords: ["Âπ∏Á¶è", "ÂÆ∂Â∫≠", "ÂíåË∞ê"], number: 10, element: "Ê∞¥" },
                    { name: "Âú£ÊùØ‰æç‰ªé", keywords: ["ÊïèÊÑü", "ÂàõÊÑè", "Áõ¥Ëßâ"], court: "‰æç‰ªé", element: "Ê∞¥" },
                    { name: "Âú£ÊùØÈ™ëÂ£´", keywords: ["Êµ™Êº´", "È≠ÖÂäõ", "ÁêÜÊÉ≥‰∏ª‰πâ"], court: "È™ëÂ£´", element: "Ê∞¥" },
                    { name: "Âú£ÊùØÁöáÂêé", keywords: ["ÂêåÊÉÖ", "ÂÖ≥ÊÄÄ", "Ê≤ªÊÑà"], court: "ÁöáÂêé", element: "Ê∞¥" },
                    { name: "Âú£ÊùØÂõΩÁéã", keywords: ["Êô∫ÊÖß", "ÊÉÖÊÑüÊéßÂà∂", "ÂØºÂ∏à"], court: "ÂõΩÁéã", element: "Ê∞¥" }
                ],
                swords: [
                    { name: "ÂÆùÂâë‰∏Ä", keywords: ["Á™ÅÁ†¥", "Ê∏ÖÊô∞", "ÁúüÁêÜ"], number: 1, element: "È£é" },
                    { name: "ÂÆùÂâë‰∫å", keywords: ["ÈÄâÊã©", "Âπ≥Ë°°", "ÂÉµÂ±Ä"], number: 2, element: "È£é" },
                    { name: "ÂÆùÂâë‰∏â", keywords: ["ÂøÉÁ¢é", "ÊÇ≤‰º§", "ÁóõËã¶"], number: 3, element: "È£é" },
                    { name: "ÂÆùÂâëÂõõ", keywords: ["‰ºëÊÅØ", "ÊÅ¢Â§ç", "Ê≤âÊÄù"], number: 4, element: "È£é" },
                    { name: "ÂÆùÂâë‰∫î", keywords: ["ÂÜ≤Á™Å", "ËÉúÂà©", "‰∫âËÆ∫"], number: 5, element: "È£é" },
                    { name: "ÂÆùÂâëÂÖ≠", keywords: ["ËøáÊ∏°", "Á¶ªÂºÄ", "Ê≤ªÊÑà"], number: 6, element: "È£é" },
                    { name: "ÂÆùÂâë‰∏É", keywords: ["Ê¨∫È™ó", "Á≠ñÁï•", "ÁßòÂØÜ"], number: 7, element: "È£é" },
                    { name: "ÂÆùÂâëÂÖ´", keywords: ["ÈôêÂà∂", "Êó†Âä©", "Ëá™ÊàëÊùüÁºö"], number: 8, element: "È£é" },
                    { name: "ÂÆùÂâë‰πù", keywords: ["ÁÑ¶Ëôë", "Âô©Ê¢¶", "ÊÅêÊÉß"], number: 9, element: "È£é" },
                    { name: "ÂÆùÂâëÂçÅ", keywords: ["ÁªìÊùü", "ÁóõËã¶", "ÈáçÁîü"], number: 10, element: "È£é" },
                    { name: "ÂÆùÂâë‰æç‰ªé", keywords: ["Ë≠¶Ëßâ", "Â•ΩÂ•á", "Êñ∞ÊÉ≥Ê≥ï"], court: "‰æç‰ªé", element: "È£é" },
                    { name: "ÂÆùÂâëÈ™ëÂ£´", keywords: ["Ë°åÂä®", "ÂÜ≤Âä®", "ÂÜ≥ÂøÉ"], court: "È™ëÂ£´", element: "È£é" },
                    { name: "ÂÆùÂâëÁöáÂêé", keywords: ["Áã¨Á´ã", "Ê∏ÖÊô∞", "ÂÖ¨Ê≠£"], court: "ÁöáÂêé", element: "È£é" },
                    { name: "ÂÆùÂâëÂõΩÁéã", keywords: ["ÊùÉÂ®Å", "ÈÄªËæë", "ÂÜ≥Êñ≠"], court: "ÂõΩÁéã", element: "È£é" }
                ],
                pentacles: [
                    { name: "ÊòüÂ∏Å‰∏Ä", keywords: ["ÁπÅËç£", "Êñ∞Êú∫‰ºö", "ÂÆâÂÖ®"], number: 1, element: "Âúü" },
                    { name: "ÊòüÂ∏Å‰∫å", keywords: ["Âπ≥Ë°°", "ÈÄÇÂ∫î", "ËµÑÊ∫ê"], number: 2, element: "Âúü" },
                    { name: "ÊòüÂ∏Å‰∏â", keywords: ["Âõ¢ÈòüÂêà‰Ωú", "Â≠¶‰π†", "ÊäÄËÉΩ"], number: 3, element: "Âúü" },
                    { name: "ÊòüÂ∏ÅÂõõ", keywords: ["‰øùÂ≠ò", "ÂÆâÂÖ®", "ÊéßÂà∂"], number: 4, element: "Âúü" },
                    { name: "ÊòüÂ∏Å‰∫î", keywords: ["Âõ∞Èöæ", "Ë¥´Âõ∞", "Â≠§Á´ã"], number: 5, element: "Âúü" },
                    { name: "ÊòüÂ∏ÅÂÖ≠", keywords: ["ÊÖ∑ÊÖ®", "ÊÖàÂñÑ", "ÂàÜ‰∫´"], number: 6, element: "Âúü" },
                    { name: "ÊòüÂ∏Å‰∏É", keywords: ["ËØÑ‰º∞", "ËÄêÂøÉ", "ÊäïËµÑ"], number: 7, element: "Âúü" },
                    { name: "ÊòüÂ∏ÅÂÖ´", keywords: ["Â∑•Ëâ∫", "‰∏ìÊ≥®", "Ë¥®Èáè"], number: 8, element: "Âúü" },
                    { name: "ÊòüÂ∏Å‰πù", keywords: ["‰∏∞ÂØå", "Áã¨Á´ã", "‰∫´Âèó"], number: 9, element: "Âúü" },
                    { name: "ÊòüÂ∏ÅÂçÅ", keywords: ["Ë¥¢ÂØå", "ÂÆ∂Â∫≠", "‰º†Áªü"], number: 10, element: "Âúü" },
                    { name: "ÊòüÂ∏Å‰æç‰ªé", keywords: ["Â≠¶‰π†", "Âã§Â•ã", "ÊΩúÂäõ"], court: "‰æç‰ªé", element: "Âúü" },
                    { name: "ÊòüÂ∏ÅÈ™ëÂ£´", keywords: ["Ë¥£‰ªª", "ÂèØÈù†", "ËøõÊ≠•"], court: "È™ëÂ£´", element: "Âúü" },
                    { name: "ÊòüÂ∏ÅÁöáÂêé", keywords: ["ÁπÅËç£", "ÂÆâÂÖ®", "ÂÖªËÇ≤"], court: "ÁöáÂêé", element: "Âúü" },
                    { name: "ÊòüÂ∏ÅÂõΩÁéã", keywords: ["ÊàêÂäü", "ÁÆ°ÁêÜ", "Á®≥ÂÆö"], court: "ÂõΩÁéã", element: "Âúü" }
                ]
            }
        };

        // ÁîüÊàêÁâåÁªÑ
        function generateDeck(deckType) {
            let deck = [];
            
            // Ê∑ªÂä†Â§ßÈòøÂç°Á∫≥
            tarotDB.major.forEach(card => {
                deck.push({
                    ...card,
                    type: "major",
                    suit: null,
                    work: generateGenericReading(card, "work"),
                    love: generateGenericReading(card, "love"),
                    study: generateGenericReading(card, "study")
                });
            });
            
            // Ê∑ªÂä†Â∞èÈòøÂç°Á∫≥
            if (deckType === "full") {
                for (const [suit, cards] of Object.entries(tarotDB.minor)) {
                    cards.forEach(card => {
                        deck.push({
                            ...card,
                            type: "minor",
                            suit: suit,
                            work: generateGenericReading(card, "work"),
                            love: generateGenericReading(card, "love"),
                            study: generateGenericReading(card, "study")
                        });
                    });
                }
            }
            
            return deck;
        }

        // ÁîüÊàêÈÄöÁî®Ëß£ËØª
        function generateGenericReading(card, category) {
            const orientation = {
                upright: [],
                reversed: []
            };
            
            // Â∑•‰ΩúËß£ËØª
            if (category === "work") {
                orientation.upright = [
                    "Â∑•‰ΩúËøõÂ±ïÈ°∫Âà©",
                    "ÂèØËÉΩÊúâÊñ∞ÁöÑÊú∫‰ºö",
                    "Âõ¢ÈòüÂêà‰ΩúËâØÂ•Ω"
                ];
                orientation.reversed = [
                    "Â∑•‰Ωú‰∏≠ÈÅáÂà∞ÈòªÁ¢ç",
                    "ÈúÄË¶ÅÈáçÊñ∞ËØÑ‰º∞ËÆ°Âàí",
                    "Ê≥®ÊÑèÊ≤üÈÄöÈóÆÈ¢ò"
                ];
            }
            // ÊÉÖÊÑüËß£ËØª
            else if (category === "love") {
                orientation.upright = [
                    "ÊÑüÊÉÖÂíåË∞ê",
                    "ÂèØËÉΩÊúâÊñ∞ÁöÑÈÇÇÈÄÖ",
                    "Ê≤üÈÄöÈ°∫ÁïÖ"
                ];
                orientation.reversed = [
                    "ÊÉÖÊÑü‰∏äÈúÄË¶ÅÊõ¥Â§öÂÖ≥Ê≥®",
                    "ÂèØËÉΩÂ≠òÂú®ËØØËß£",
                    "ÈúÄË¶ÅÊõ¥Â§öËÄêÂøÉ"
                ];
            }
            // Â≠¶‰π†Ëß£ËØª
            else if (category === "study") {
                orientation.upright = [
                    "Â≠¶‰π†ÊïàÁéáÈ´ò",
                    "ÈÄÇÂêàÂê∏Êî∂Êñ∞Áü•ËØÜ",
                    "ËÄÉËØïËøê‰Ω≥"
                ];
                orientation.reversed = [
                    "Â≠¶‰π†ÈÅáÂà∞Áì∂È¢à",
                    "ÈúÄË¶ÅË∞ÉÊï¥ÊñπÊ≥ï",
                    "Ê≥®ÊÑèÂäõ‰∏çÈõÜ‰∏≠"
                ];
            }
            
            // Ê∑ªÂä†Âª∫ËÆÆ
            orientation.advice = {
                upright: "ÊääÊè°ÂΩì‰∏ãÊú∫‰ºöÔºåÁßØÊûÅË°åÂä®",
                reversed: "Ë∞®ÊÖéË°å‰∫ãÔºå‰∏âÊÄùËÄåÂêéË°å"
            };
            
            return orientation;
        }

        // Ê¥óÁâåÁÆóÊ≥ï
        function shuffleDeck(deck) {
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
            return deck;
        }

        // ÊäΩÂèñÁâåÁªÑ
        function drawCards() {
            try {
                const deckType = document.querySelector('input[name="deckType"]:checked').value;
                let deck = generateDeck(deckType);
                
                if (deck.length === 0) {
                    throw new Error("ÁâåÁªÑ‰∏∫Á©∫ÔºåËØ∑Ê£ÄÊü•ÁâåÁªÑÊï∞ÊçÆ");
                }
                
                deck = shuffleDeck(deck);
                
                return deck.slice(0, 3).map(card => ({
                    ...card,
                    orientation: Math.random() > 0.5 ? "Ê≠£‰Ωç" : "ÈÄÜ‰Ωç"
                }));
            } catch (error) {
                console.error("ÊäΩÁâåÂá∫Èîô:", error);
                showError("ÊäΩÁâåÂ§±Ë¥•ÔºåËØ∑Âà∑Êñ∞È°µÈù¢ÈáçËØï");
                return [];
            }
        }

        // ÊòæÁ§∫ÈîôËØØ‰ø°ÊÅØ
        function showError(message) {
            const errorEl = document.getElementById("errorMsg");
            errorEl.textContent = message;
            errorEl.classList.remove("hidden");
        }

        // ÈöêËóèÈîôËØØ‰ø°ÊÅØ
        function hideError() {
            document.getElementById("errorMsg").classList.add("hidden");
        }

        // ÁîüÊàêÁªºÂêàËß£ËØª
        function generateOverallReading(cards) {
            const reading = {
                elements: {},
                overallEnergy: 50, // ÈªòËÆ§50%
                themes: []
            };
            
            // ÂàÜÊûêÂÖÉÁ¥†ÂíåÊ≠£ÈÄÜ‰Ωç
            let uprightCount = 0;
            cards.forEach(card => {
                // ÁªüËÆ°ÂÖÉÁ¥†
                if (card.element) {
                    reading.elements[card.element] = (reading.elements[card.element] || 0) + 1;
                }
                
                // ÁªüËÆ°Ê≠£ÈÄÜ‰Ωç
                if (card.orientation === "Ê≠£‰Ωç") {
                    uprightCount++;
                }
                
                // Êî∂ÈõÜÂÖ≥ÈîÆËØç
                reading.themes.push(...card.keywords);
            });
            
            // ËÆ°ÁÆóËÉΩÈáèÂÄº (0-100)
            if (uprightCount === 3) {
                reading.overallEnergy = 90;
            } else if (uprightCount === 2) {
                reading.overallEnergy = 70;
            } else if (uprightCount === 1) {
                reading.overallEnergy = 40;
            } else {
                reading.overallEnergy = 20;
            }
            
            // ÁîüÊàêËß£ËØªÊñáÊú¨
            reading.summary = generateSummaryText(uprightCount, reading.themes);
            reading.elementAnalysis = generateElementAnalysis(reading.elements);
            reading.advice = generateAdviceText(uprightCount);
            
            return reading;
        }

        // ÁîüÊàêÊÄªÁªìÊñáÊú¨
        function generateSummaryText(uprightCount, themes) {
            const uniqueThemes = [...new Set(themes)].slice(0, 3);
            
            if (uprightCount === 3) {
                return `üåü ‰ªäÊó•ËøêÂäøÊûÅ‰Ω≥ÔºÅ‰∏âÂº†Ê≠£‰ΩçÁâåÊòæÁ§∫ËÉΩÈáèÂÖÖÊ≤õÔºåÊòØÊé®ËøõËÆ°ÂàíÁöÑÂ•ΩÊó∂Êú∫„ÄÇÂÖ≥ÈîÆËØçÔºö${uniqueThemes.join("„ÄÅ")}`;
            } else if (uprightCount === 2) {
                return `‚ú® ‰ªäÊó•ËøêÂäøËâØÂ•Ω„ÄÇ‰∏§Âº†Ê≠£‰ΩçÁâåÊòæÁ§∫Êï¥‰ΩìÈ°∫Âà©Ôºå‰ΩÜÈúÄÁïôÊÑèÈÄÜ‰ΩçÁâåÊèêÁ§∫ÁöÑÈ¢ÜÂüü„ÄÇÂÖ≥ÈîÆËØçÔºö${uniqueThemes.join("„ÄÅ")}`;
            } else if (uprightCount === 1) {
                return `‚è≥ ‰ªäÊó•ËøêÂäøÂπ≥Á®≥„ÄÇÈúÄË¶ÅÂπ≥Ë°°ÂêÑÊñπËÉΩÈáèÔºåÈÄÜ‰ΩçÁâåÊèêÁ§∫ÈúÄÁïôÊÑèÁöÑÊåëÊàò„ÄÇÂÖ≥ÈîÆËØçÔºö${uniqueThemes.join("„ÄÅ")}`;
            } else {
                return `üåô ‰ªäÊó•ÈúÄË¶ÅË∞®ÊÖé„ÄÇ‰∏âÂº†ÈÄÜ‰ΩçÁâåÊèêÁ§∫ÈúÄÊîæÊÖ¢ËÑöÊ≠•ÔºåÂèçÊÄùË∞ÉÊï¥ÂêéÂÜçË°åÂä®„ÄÇÂÖ≥ÈîÆËØçÔºö${uniqueThemes.join("„ÄÅ")}`;
            }
        }

        // ÁîüÊàêÂÖÉÁ¥†ÂàÜÊûê
        function generateElementAnalysis(elements) {
            if (Object.keys(elements).length === 0) return "";
            
            const elementMeanings = {
                "ÁÅ´": "Ë°åÂä®ÂäõÂº∫ÔºåÁÉ≠ÊÉÖÂÖÖÊ≤õ",
                "Ê∞¥": "ÊÉÖÊÑü‰∏∞ÂØåÔºåÁõ¥ËßâÊïèÈîê",
                "È£é": "ÊÄùÁª¥Ê¥ªË∑ÉÔºåÊ≤üÈÄöÈ°∫ÁïÖ",
                "Âúü": "Âä°ÂÆûÁ®≥ÂÆöÔºåË¥¢Âä°ËâØÂ•Ω",
                "ÈáëÊòü": "Áà±‰∏éÁæéÁöÑËÉΩÈáè",
                "Êú®Êòü": "Âπ∏Ëøê‰∏éÊâ©Âº†",
                "Ê∞¥Êòü": "Ê≤üÈÄö‰∏éÊÄùÁª¥",
                "Êúà‰∫Æ": "Áõ¥Ëßâ‰∏éÊΩúÊÑèËØÜ",
                "Â§™Èò≥": "Ê¥ªÂäõ‰∏éÊàêÂäü",
                "ÁÅ´Êòü": "Ë°åÂä®‰∏éÂãáÊ∞î"
            };
            
            const dominantElement = Object.entries(elements)
                .sort((a, b) => b[1] - a[1])[0][0];
            
            return `‰∏ªÂØºÂÖÉÁ¥† ${dominantElement}Ôºö${elementMeanings[dominantElement] || "ËÉΩÈáèÂπ≥Ë°°"}`;
        }

        // ÁîüÊàêÂª∫ËÆÆÊñáÊú¨
        function generateAdviceText(uprightCount) {
            if (uprightCount === 3) {
                return "Â§ßËÉÜËøΩÊ±ÇÁõÆÊ†áÔºå‰ΩÜË¶ÅÊ≥®ÊÑè‰∏çË¶ÅËøáÂ∫¶Ëá™‰ø°";
            } else if (uprightCount === 2) {
                return "ÊääÊè°Êú∫‰ºöÂêåÊó∂ÁïôÊÑèÊΩúÂú®ÈóÆÈ¢ò";
            } else if (uprightCount === 1) {
                return "ÈáçË¶ÅÂÜ≥ÂÆöËØ∑‰∏âÊÄùËÄåÂêéË°å";
            } else {
                return "Âª∫ËÆÆÊîæÊÖ¢ËÑöÊ≠•ÔºåÂ§öÂèçÊÄùËÄåÈùûË°åÂä®";
            }
        }

        // ÊòæÁ§∫ÁâåÁªÑ
        function displayCards(cards) {
            const cardDisplay = document.getElementById("cardDisplay");
            cardDisplay.innerHTML = "";
            
            if (!cards || cards.length === 0) {
                showError("Êú™ËÉΩÊàêÂäüÊäΩÁâå");
                return;
            }
            
            hideError();
            cardDisplay.classList.remove("hidden");
            
            cards.forEach((card, index) => {
                const cardEl = document.createElement("div");
                cardEl.className = "card dealing";
                
                let cardInfo = `
                    <div class="card-face card-back"></div>
                    <div class="card-face card-front">
                        <div class="card-name">${card.name}</div>
                `;
                
                if (card.suit) {
                    cardInfo += `<div class="card-suit">${getSuitName(card.suit)}ÁâåÁªÑ</div>`;
                }
                
                cardInfo += `
                        <div class="card-orientation">${card.orientation}</div>
                    </div>
                `;
                
                cardEl.innerHTML = cardInfo;
                cardDisplay.appendChild(cardEl);
                
                // Ê∑ªÂä†ÁÇπÂáªÁøªËΩ¨ÂäüËÉΩ
                cardEl.addEventListener('click', function() {
                    this.classList.toggle('flipped');
                });
                
                // Ëá™Âä®ÁøªËΩ¨Âç°Áâá
                setTimeout(() => {
                    cardEl.classList.remove('dealing');
                    setTimeout(() => {
                        cardEl.classList.add('flipped');
                    }, index * 300);
                }, 100);
            });
        }

        // Ëé∑ÂèñËä±Ëâ≤ÂêçÁß∞
        function getSuitName(suit) {
            const suitNames = {
                "wands": "ÊùÉÊùñ",
                "cups": "Âú£ÊùØ",
                "swords": "ÂÆùÂâë",
                "pentacles": "ÊòüÂ∏Å"
            };
            return suitNames[suit] || suit;
        }

        // ÊòæÁ§∫Ëß£ËØª
        function displayReading(cards) {
            try {
                const reading = generateOverallReading(cards);
                const categories = ["work", "love", "study"];
                
                // ÊòæÁ§∫ÁªºÂêàËß£ËØª
                document.getElementById("overallReading").innerHTML = `
                    <p>${reading.summary}</p>
                    <p>${reading.elementAnalysis}</p>
                `;
                
                // ÊòæÁ§∫ËÉΩÈáèÊù°
                document.getElementById("energyLevel").style.width = `${reading.overallEnergy}%`;
                
                // ÊòæÁ§∫ÂÖÉÁ¥†Ê†áÁ≠æ
                const elementTags = document.getElementById("elementTags");
                elementTags.innerHTML = "";
                Object.keys(reading.elements).forEach(element => {
                    const tag = document.createElement("div");
                    tag.className = "element-tag";
                    tag.textContent = element;
                    elementTags.appendChild(tag);
                });
                
                // ÊòæÁ§∫‰ªäÊó•ÁÆ¥Ë®Ä
                document.getElementById("dailyAdvice").textContent = reading.advice;
                
                // ÊòæÁ§∫ÂêÑÈ¢ÜÂüüËß£ËØª
                categories.forEach((category, index) => {
                    const card = cards[index];
                    const isUpright = card.orientation === "Ê≠£‰Ωç";
                    const meanings = isUpright ? card[category].upright : card[category].reversed;
                    const advice = card[category].advice[isUpright ? "upright" : "reversed"];
                    
                    document.getElementById(`${category}Reading`).innerHTML = `
                        <p><strong>${card.name} ${card.orientation}</strong></p>
                        <p>${meanings.join(" ¬∑ ")}</p>
                        <p><em>Âª∫ËÆÆÔºö${advice}</em></p>
                    `;
                });
                
                document.getElementById("readingDisplay").classList.remove("hidden");
            } catch (error) {
                console.error("Ëß£ËØªÁîüÊàêÂ§±Ë¥•:", error);
                showError("Ëß£ËØªÁîüÊàêÂ§±Ë¥•ÔºåËØ∑ÈáçÊñ∞ÊäΩÁâå");
            }
        }

        // ‰∏ªÂáΩÊï∞
        document.getElementById("drawBtn").addEventListener("click", function() {
            const btn = this;
            btn.disabled = true;
            btn.textContent = "Ê≠£Âú®ÊäΩÁâå...";
            
            // Ê∏ÖÁ©∫‰πãÂâçÁöÑÁªìÊûú
            document.getElementById("readingDisplay").classList.add("hidden");
            hideError();
            
            setTimeout(() => {
                try {
                    const cards = drawCards();
                    displayCards(cards);
                    
                    if (cards.length > 0) {
                        setTimeout(() => {
                            displayReading(cards);
                        }, 1500);
                    }
                } catch (error) {
                    console.error("ÊäΩÁâåÊµÅÁ®ãÂá∫Èîô:", error);
                    showError("Á≥ªÁªüÂá∫ÈîôÔºåËØ∑Âà∑Êñ∞È°µÈù¢ÈáçËØï");
                } finally {
                    btn.disabled = false;
                    btn.textContent = "ÊäΩÂèñ‰ªäÊó•ËøêÂäø";
                }
            }, 800);
        });

        // Á¶ÅÊ≠¢ÂèåÂáªÁº©Êîæ (ÈíàÂØπÁßªÂä®Á´Ø)
        document.addEventListener('dblclick', function(e) {
            e.preventDefault();
        }, { passive: false });
    </script>
</body>
</html>